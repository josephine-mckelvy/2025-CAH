---
title: "2025-CAH"
author: "Josephine McKelvy"
date: "2025-06-30"
output: html_document
---
# Getting Started
This R markdown files includes steps for ...
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)

# Install packages (one-time)

# Load libraries:
library(dplyr)
library(ggplot2)
library(knitr)
library(readr) 
library(summarytools)
```
# Transforming, Cleaning
```{r}
# Load Data sets:
Data_set_A <- readr::read_csv("Data set A.csv")
Data_set_B <- readr::read_csv("Data set B.csv")

# Merge data frames by ID variable
contiguous <- merge(Data_set_A, Data_set_B, by="identifier")
summarytools::dfSummary(contiguous) 

# There are multiple duplicates and 371 distinct identifiers common to both data sets, thus up to 371 cases for the analytic sample. 
# Remove empty rows and duplicate cases:
contiguous <- distinct(contiguous) 

# There are still 3 rows with missing conditions.
# Keep cases where condition is not missing:
contiguous <- filter(contiguous,!is.na(condition)) 

# There are 3 character (or raw text) columns (that should be factor variables) and an identifier that is a double (or real number) data type.
# Save categorical variables as factor:
contiguous <- contiguous %>%
  mutate(
    condition = factor(condition,
                       levels = c("recommendation","control")), #order matters for the contingency table
    income_level = factor(income_level,
                          levels = c("non-LMI","LMI")),
    increased_contribution = factor(increased_contribution,
                                    levels = c("1","closed"), #order matters for the contingency table
                                    labels = c("contributed","closed")) 
  )
```
## Exploratory Data Analysis 
https://bookdown.org/lyzhang10/lzhang_r_tips_book/preface.html
https://geanders.github.io/RProgrammingForResearch/exploring-data-1.html
```{r}
ggplot(data = contiguous) +
  geom_count(mapping = aes(x = condition, y = increased_contribution)) 

ggplot(contiguous, aes(x = condition, y = increased_contribution)) + geom_point()
```
## Analysis

Null Hypothesis: There is no association between receiving a recommendation and increasing contributions. The likelihood of increased contributions is the same across the two conditions.

```{r}
# Return the frequencies/counts of the categorical outcome by condition:
ctab <- table(contiguous$condition, contiguous$increased_contribution)
print(ctab) # At least 2 cells have frequencies that are less than 5, so a Fisher's exact test may be more appropriate. But overall, it looks like everyone increased contributions, regardless of condition.
summary.table(ctab) # Returns the chisq. P-value of 1 means we cannot reject the null. In other words, there is no difference in outcomes between the two conditions.

fisher.test(ctab) # the odds of the control group closing (?) is almost the same (i.e., 1.3 times) as the odds of those who received a recommendation.


```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.
